@page "/todos"
@inject IAsyncRepository<Todo> TodoRepository
@inject IAsyncRepository<TodoList> TodoListRepository


@if (_lists.Any())
{
    <MudGrid Justify="Justify.SpaceEvenly">
        @foreach (var list in _lists)
        {
            <MudItem>
                <TodoListCard List="@list" OnDelete="@(() => DeleteList(list))"></TodoListCard>
            </MudItem>
        }
    </MudGrid>
}

<MudButton OnClick="AddList">Add List</MudButton>

<MudDivider/>

@foreach (var todo in _uncategorized)
{
    <TodoItem></TodoItem>
}
<MudButton>Add Todo</MudButton>


@code {

    private IEnumerable<TodoList> _lists = Enumerable.Empty<TodoList>();
    private IEnumerable<Todo> _uncategorized = Enumerable.Empty<Todo>();

    /// <inheritdoc />
    protected override async Task OnInitializedAsync()
    {
        _uncategorized = await TodoRepository.All();
        _lists = await TodoListRepository.All();
    }

    private async Task AddList()
    {
        await TodoListRepository.Create();
        _lists = await TodoListRepository.All();
    }

    private async Task DeleteList(TodoList list)
    {
        await TodoListRepository.Delete(list);
        _lists = await TodoListRepository.All();
    }

}