<MudPaper Style="position: relative;" Elevation="0">

    @ChildContent

    <MudOverlay Absolute="true" DarkBackground="IsDarkOverlay()" LightBackground="IsLightOverlay()" Visible="@(Status != OverlayStatus.Content)">

        @if (Status == OverlayStatus.Loading)
        {
            <MudProgressCircular Color="Color.Secondary" Indeterminate="true"/>
        }

        @if (Status == OverlayStatus.Unknown)
        {
            <MudIcon Icon="@(Icons.Filled.Help)" Color="Color.Info" Size="Size.Large"/>
        }

        @if (Status == OverlayStatus.Error)
        {
            <MudIcon Icon="@(Icons.Filled.Error)" Color="Color.Error" Size="Size.Large"/>
        }

    </MudOverlay>
</MudPaper>


@code {

    public enum OverlayStatus
    {
        Content,
        Unknown,
        Loading,
        Error
    }

    public enum OverlayBackground
    {
        Auto,
        Dark,
        Light
    }


    [Parameter]
    public RenderFragment ChildContent { get; set; }

    [Parameter]
    public OverlayStatus Status { get; set; } = OverlayStatus.Content;

    [Parameter]
    public OverlayBackground Background { get; set; } = OverlayBackground.Auto;

    private bool IsDarkOverlay()
    {
        if (Background == OverlayBackground.Dark)
        {
            return true;
        }

        if (Background == OverlayBackground.Auto)
        {
            return Status == OverlayStatus.Error;
        }
        return false;
    }

    private bool IsLightOverlay()
    {
        if (Background == OverlayBackground.Light)
        {
            return true;
        }

        if (Background == OverlayBackground.Auto)
        {
            return Status is OverlayStatus.Loading or OverlayStatus.Unknown;
        }

        return false;
    }

}